<!DOCTYPE html>
<html class="no-js" lang="zxx">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Checkout - Flower eCommerce" />
    <title>Checkout - Flower eCommerce</title>

    <!--=== Favicon ===-->
    <link
      rel="shortcut icon"
      href="../../images/favicon.ico"
      type="image/x-icon"
    />

    <!-- Google fonts include -->
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,900%7CYesteryear"
      rel="stylesheet"
    />

    <!-- All Vendor & plugins CSS include -->
    <link href="../../css/vendor.css" rel="stylesheet" />
    <!-- Main Style CSS -->
    <link href="../../css/style.css" rel="stylesheet" />
    <!-- Cart CSS for styling -->
    <link href="../../css/cart.css" rel="stylesheet" />
    <!-- Checkout CSS for styling -->
    <link href="../../css/checkout.css" rel="stylesheet" />

    <!--[if lt IE 9]>
      <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <!-- Load Header Component -->
    <header
      id="header-placeholder"
      hx-get="../components/header.html"
      hx-trigger="load"
      hx-swap="outerHTML"
    ></header>

    <!-- main wrapper start -->
    <main>
      <!-- breadcrumb area start -->
      <div class="breadcrumb-area common-bg">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="breadcrumb-wrap">
                <nav aria-label="breadcrumb">
                  <h1>Thanh toán</h1>
                  <ul class="breadcrumb">
                    <li class="breadcrumb-item">
                      <a href="../common/homepage.html"
                        ><i class="fa fa-home"></i
                      ></a>
                    </li>
                    <li class="breadcrumb-item">
                      <a href="../user/cart.html">Giỏ hàng</a>
                    </li>
                    <li class="breadcrumb-item active" aria-current="page">
                      Thanh toán
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- breadcrumb area end -->

      <!-- checkout main wrapper start -->
      <div class="checkout-page-wrapper section-space pb-0">
        <div class="container">
          <div class="row">
            <!-- Checkout Billing Details -->
            <div class="col-lg-6">
              <div class="checkout-billing-details-wrap">
                <h2>Thông tin thanh toán</h2>
                <div class="billing-form-wrap">
                  <form id="checkoutForm">
                    <div class="row">
                      <div class="col-md-6">
                        <div class="single-input-item">
                          <label for="firstName" class="required">Họ</label>
                          <input
                            type="text"
                            id="firstName"
                            name="firstName"
                            placeholder="Họ"
                            required
                          />
                          <div class="form-error" id="firstNameError">
                            Vui lòng nhập họ
                          </div>
                        </div>
                      </div>
                      <div class="col-md-6">
                        <div class="single-input-item">
                          <label for="lastName" class="required">Tên</label>
                          <input
                            type="text"
                            id="lastName"
                            name="lastName"
                            placeholder="Tên"
                            required
                          />
                          <div class="form-error" id="lastNameError">
                            Vui lòng nhập tên
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="single-input-item">
                      <label for="email" class="required">Email</label>
                      <input
                        type="email"
                        id="email"
                        name="email"
                        placeholder="Email"
                        required
                      />
                      <div class="form-error" id="emailError">
                        Vui lòng nhập email hợp lệ
                      </div>
                    </div>

                    <div class="single-input-item">
                      <label for="streetAddress" class="required"
                        >Địa chỉ</label
                      >
                      <input
                        type="text"
                        id="streetAddress"
                        name="streetAddress"
                        placeholder="Địa chỉ (số nhà, đường, phường/xã)"
                        required
                      />
                      <div class="form-error" id="streetAddressError">
                        Vui lòng nhập địa chỉ
                      </div>
                    </div>

                    <div class="single-input-item">
                      <input
                        type="text"
                        id="streetAddress2"
                        name="streetAddress2"
                        placeholder="Địa chỉ bổ sung (không bắt buộc)"
                      />
                    </div>

                    <div class="single-input-item">
                      <label for="city" class="required">Thành phố</label>
                      <input
                        type="text"
                        id="city"
                        name="city"
                        placeholder="Thành phố"
                        required
                      />
                      <div class="form-error" id="cityError">
                        Vui lòng nhập thành phố
                      </div>
                    </div>

                    <div class="single-input-item">
                      <label for="state">Tỉnh/Quận/Huyện</label>
                      <input
                        type="text"
                        id="state"
                        name="state"
                        placeholder="Tỉnh/Quận/Huyện"
                      />
                    </div>

                    <div class="single-input-item">
                      <label for="phone" class="required">Số điện thoại</label>
                      <input
                        type="tel"
                        id="phone"
                        name="phone"
                        placeholder="Số điện thoại"
                        required
                      />
                      <div class="form-error" id="phoneError">
                        Vui lòng nhập số điện thoại
                      </div>
                    </div>

                    <div class="single-input-item">
                      <label for="orderNotes">Ghi chú đơn hàng</label>
                      <textarea
                        name="orderNotes"
                        id="orderNotes"
                        cols="30"
                        rows="3"
                        placeholder="Ghi chú về đơn hàng, ví dụ hướng dẫn giao hàng."
                      ></textarea>
                    </div>
                  </form>
                </div>
              </div>
            </div>

            <!-- Order Summary Details -->
            <div class="col-lg-6">
              <div class="order-summary-details">
                <h2>Đơn hàng của bạn</h2>
                <div class="order-summary-content">
                  <!-- Order Summary Table -->
                  <div class="order-summary-table table-responsive text-center">
                    <!-- Loading State -->
                    <div id="orderSummaryLoading" class="text-center p-4">
                      <div class="spinner-border text-primary" role="status">
                        <span class="sr-only">Loading...</span>
                      </div>
                      <p class="mt-2">Đang tải giỏ hàng...</p>
                    </div>

                    <table
                      class="table table-bordered"
                      id="orderSummaryTable"
                      style="display: none"
                    >
                      <thead>
                        <tr>
                          <th><strong>Sản phẩm</strong></th>
                          <th><strong>Tổng</strong></th>
                        </tr>
                      </thead>
                      <tbody id="orderSummaryBody">
                        <!-- Cart items will be populated here -->
                      </tbody>
                      <tfoot>
                        <tr>
                          <td>Tạm tính</td>
                          <td id="subtotalAmount">0 ₫</td>
                        </tr>
                        <tr>
                          <td>Phí dịch vụ (50%)</td>
                          <td id="serviceFeeAmount">0 ₫</td>
                        </tr>
                        <tr class="total-row">
                          <td><strong>Tổng cộng</strong></td>
                          <td id="totalAmount"><strong>0 ₫</strong></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>

                  <!-- Cart Empty State -->
                  <div
                    id="cartEmptyState"
                    class="text-center p-4"
                    style="display: none"
                  >
                    <i class="fa fa-shopping-cart fa-3x text-muted mb-3"></i>
                    <h5>Giỏ hàng trống</h5>
                    <p class="text-muted">
                      Vui lòng thêm sản phẩm vào giỏ trước khi thanh toán.
                    </p>
                    <div class="mb-3">
                      <a href="../user/cart.html" class="btn btn__bg me-2"
                        >Xem giỏ hàng</a
                      >
                      <button
                        type="button"
                        id="refreshCartBtn"
                        class="btn btn-outline-primary"
                      >
                        Tải lại giỏ hàng
                      </button>
                    </div>
                  </div>

                  <!-- Order Payment Method -->
                  <div class="order-payment-method">
                    <div class="single-payment-method show">
                      <div class="payment-method-name">
                        <div class="custom-control custom-radio">
                          <input
                            type="radio"
                            id="cashOnDelivery"
                            name="paymentMethod"
                            value="cash"
                            class="custom-control-input"
                            checked
                          />
                          <label
                            class="custom-control-label"
                            for="cashOnDelivery"
                            >Thanh toán khi nhận hàng</label
                          >
                        </div>
                      </div>
                      <div
                        class="payment-method-details show"
                        data-method="cash"
                      >
                        <p>Thanh toán bằng tiền mặt khi nhận hàng.</p>
                      </div>
                    </div>

                    <div class="single-payment-method">
                      <div class="payment-method-name">
                        <div class="custom-control custom-radio">
                          <input
                            type="radio"
                            id="vnpay"
                            name="paymentMethod"
                            value="vnpay"
                            class="custom-control-input"
                          />
                          <label class="custom-control-label" for="vnpay"
                            >Thanh toán bằng VNPay</label
                          >
                        </div>
                      </div>
                      <div class="payment-method-details" data-method="vnpay">
                        <p>Thanh toán an toàn qua VNPay.</p>
                      </div>
                    </div>

                    <div class="summary-footer-area">
                      <button
                        type="button"
                        id="placeOrderBtn"
                        class="btn btn__bg"
                      >
                        Đặt hàng
                        <span class="loading-spinner" id="orderLoadingSpinner">
                          <i class="fa fa-spinner fa-spin"></i>
                        </span>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- checkout main wrapper end -->
    </main>
    <!-- main wrapper end -->

    <!-- Load Footer Component -->
    <footer
      id="footer-placeholder"
      hx-get="../components/footer.html"
      hx-trigger="load"
      hx-swap="outerHTML"
    ></footer>

    <!-- Scripts -->
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
    <script src="../../js/vendor.js"></script>
    <script src="../../js/active.js"></script>

    <!-- Services and Components -->
    <script type="module" src="../../js/services/ApiService.js"></script>
    <script
      type="module"
      src="../../js/component/header/HeaderManager.js"
    ></script>
    <script type="module" src="../../js/checkout.js"></script>

    <script type="module">
      // Initialize checkout functionality
      import { CheckoutManager } from "../../js/checkout.js";

      document.addEventListener("DOMContentLoaded", function () {
        // Initialize checkout functionality
        console.log("Creating CheckoutManager instance...");
        window.checkoutManager = new CheckoutManager();
        console.log("CheckoutManager created:", window.checkoutManager);
      });
    </script>
  </body>
</html>
